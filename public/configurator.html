<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configurare Cabine de Duș</title>
    <link rel="stylesheet" href="config_style.css">
</head>
<body>
<div class="container">
    <h1>Configurare Cabine de Duș</h1>

    <div class="form-row">
        <div class="form-group">
            <label for="cabinTypeSelect">Tip Cabina:</label>
            <select id="cabinTypeSelect" onchange="updateFeronerie()">
                <option value="">-- Selectați Tipul de Cabina --</option>
                <option value="batanta">Cabina Batanta</option>
                <option value="culisanta">Cabina Culisanta</option>
                <option value="usi_toc_aluminiu_lemn">Usi Toc Aluminiu (Lemn)</option>
            </select>
        </div>

        <div class="form-group">
            <label for="dimensionsInput">Dimensiuni (Lățime x Înălțime):</label>
            <input type="text" id="dimensionsInput" placeholder="Ex: 90 200">
        </div>

        <div class="form-group">
            <label for="materialSelect">Material:</label>
            <select id="materialSelect">
                <option value="">-- Selectați Materialul --</option>
                <option value="Zinc">Zinc</option>
                <option value="Aluminiu">Aluminiu</option>
                <option value="Otel inoxidabil#304">Otel inoxidabil#304</option>
            </select>
        </div>

        <div class="form-group">
            <label for="finishColorSelect">Culoare Finisaj:</label>
            <select id="finishColorSelect">
                <option value="">-- Selectați Culoarea --</option>
                <option value="satin">Satin</option>
                <option value="lucios">Lucios</option>
                <option value="negru">Negru</option>
                <option value="alb">Alb</option>
                <option value="gold">Gold</option>
                <option value="rose-gold">Rose-Gold</option>
            </select>
        </div>
    </div>

    <div id="hardwareSelection" class="hardware-grid" style="display: none;">
        <h2>Selectați Feroneria</h2>

        <div id="batantaFeronerie" style="display: none;">
            <h3>Feronerie pentru Cabina Batanta</h3>
            <label for="balamaleSelect">Balamale:</label>
            <select id="balamaleSelect"></select>

            <label for="manerbutonSelect">Mânere Buton:</label>
            <select id="manerbutonSelect"></select>

            <label for="manereDiverseSelect">Mânere Diverse:</label>
            <select id="manereDiverseSelect"></select>

            <label for="profileSelect">Profile:</label>
            <select id="profileSelect"></select>

            <label for="profileRigidizareSelect">Profile Rigidizare:</label>
            <select id="profileRigidizareSelect"></select>

            <label for="garnituriSelect">Garnituri:</label>
            <select id="garnituriSelect"></select>
        </div>

        <div id="culisantaFeronerie" style="display: none;">
            <h3>Feronerie pentru Cabina Culisanta</h3>
            <label for="profileSelectCulisanta">Profile:</label>
            <select id="profileSelectCulisanta"></select>

            <label for="setGlisantaSelect">Set Glisantă pentru Cabine de Duș:</label>
            <select id="setGlisantaSelect"></select>
        </div>
    </div>

    <div class="price-section" style="display: none;">
        <h2>Preturi</h2>
        <div id="priceDetails"></div>
    </div>

</div>

<footer>
    &copy; 2024 Configurator Cabine de Duș
</footer>

<script src="../JS_functions/database_functions.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        updateFeronerie(); // Ensure the UI is correctly set based on the selected value
        fetchDropdownData(); // Fetch dropdown data on page load
    });

    // Function to update the feronerie options
    function updateFeronerie() {
        const cabinType = document.getElementById('cabinTypeSelect').value;
        const hardwareSection = document.getElementById('hardwareSelection');
        const batantaSection = document.getElementById('batantaFeronerie');
        const culisantaSection = document.getElementById('culisantaFeronerie');

        // Hide both sections initially
        batantaSection.style.display = 'none';
        culisantaSection.style.display = 'none';
        hardwareSection.style.display = 'block'; // Always show the hardware section once a type is selected

        if (cabinType === 'batanta') {
            batantaSection.style.display = 'block';
        } else if (cabinType === 'culisanta') {
            culisantaSection.style.display = 'block';
        }
    }

    // Fetch dropdown data from the server and populate the selects
    async function fetchDropdownData() {
        try {
            const tables = [
                'balamale', 'manerebuton', 'manerediverse',
                'profile', 'garnituri'
            ];

            // Loop through each table and fetch data
            for (const table of tables) {
                const response = await fetch(`http://localhost:3000/api/${table}`);
                const data = await response.json();

                console.log(`Data for ${table}:`, data); // Debugging: log data to ensure correct data is fetched

                populateDropdown(table, data);
            }
        } catch (error) {
            console.error('Error fetching dropdown data:', error);
        }
    }

    // Populate the dropdown options based on the table name and data
    function populateDropdown(table, data) {
        let dropdownId;
        switch (table) {
            case 'balamale':
                dropdownId = 'balamaleSelect';
                break;
            case 'manerebuton':
                dropdownId = 'manerbutonSelect';
                break;
            case 'manerediverse':
                dropdownId = 'manereDiverseSelect';
                break;
            case 'profile':
                dropdownId = 'profileSelect';
                break;
            case 'garnituri':
                dropdownId = 'garnituriSelect';
                break;
            default:
                return;
        }

        const dropdown = document.getElementById(dropdownId);
        dropdown.innerHTML = ''; // Clear existing options

        // If data is returned, populate the dropdown
        if (data && data.length > 0) {
            data.forEach(item => {
                const option = document.createElement('option');
                option.value = item.CodProdus;
                option.textContent = `${item.CodProdus} - ${item.Denumire}`; // Display CodProdus and Denumire
                dropdown.appendChild(option);
            });
        } else {
            const option = document.createElement('option');
            option.textContent = `No data available for ${table}`;
            dropdown.appendChild(option);
        }
    }
</script>



</body>
</html>
