<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configurare Cabine de Duș</title>
    <link rel="stylesheet" href="config_style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">

</head>
<body>
<header class="top-header">
    <div class="logo-container">
        <img src="./Pictures/M3Loggo.png" alt="M3izoglass Logo" class="logo">
        <span>Configurator pentru cabine de duș atipice</span>
    </div>
    <div class="contact-info">
        <p>Pentru mai multe informații, sunați la:</p>
        <p class="phone-numbers">0040 314 255 870 / 729 819 129</p>
        <p>Email: <a href="mailto:m3.prod@izoglass.com">m3.prod@izoglass.com</a></p>
        <p>Luni - Vineri, între orele 08:00 - 16:30</p>
    </div>
    <div class="social-links">
        <div class="icon-home"></div>
        <div class="icon-mail"></div>
        <div class="icon-info"></div>


        <div class="language-selector">
            <span>ROMÂNIA</span>
            <i class="icon icon-arrow-down"></i>
        </div>
    </div>
</header>

<div class="container">
    <h1>Configurare Cabine de Duș</h1>

    <!-- Step 1: Select Cabina -->
    <div class="form-row">
        <div class="form-group">
            <label for="cabinTypeSelect">Tip Cabina:</label>
            <select id="cabinTypeSelect" onchange="updateFeronerie()">
                <option value="">-- Selectați Tipul de Cabina --</option>
                <option value="batanta">Cabina Batanta</option>
                <option value="culisanta">Cabina Culisanta</option>
            </select>
        </div>

        <div class="form-group">
            <label for="dimensionsInput">Dimensiuni (Lățime x Înălțime):</label>
            <input type="text" id="dimensionsInput" placeholder="Ex: 90 200">
        </div>
    </div>

    <!-- Step 2: Material and Finish Selection -->
    <div class="form-row">
        <div class="form-group">
            <label for="materialSelect">Material:</label>
            <select id="materialSelect">
                <option value="">-- Selectați Materialul --</option>
                <option value="Zinc">Zinc</option>
                <option value="Aluminiu">Aluminiu</option>
                <option value="Otel inoxidabil#304">Otel inoxidabil#304</option>
            </select>
        </div>

        <div class="form-group">
            <label for="finishColorSelect">Culoare Finisaj:</label>
            <select id="finishColorSelect">
                <option value="">-- Selectați Culoarea --</option>
                <option value="satin">Satin</option>
                <option value="lucios">Lucios</option>
                <option value="negru">Negru</option>
                <option value="alb">Alb</option>
                <option value="gold">Gold</option>
                <option value="rose-gold">Rose-Gold</option>
            </select>
        </div>
    </div>

    <!-- Step 3: Hardware Selection (Accordion Layout) -->
    <div id="hardwareSelection" class="accordion-container">
        <h2>Selectați Feroneria</h2>

        <div id="batantaFeronerie" class="accordion-section" style="display: none;">
            <h3 onclick="toggleAccordion('batantaFeronerie')">Feronerie pentru Cabina Batanta</h3>
            <div class="accordion-content">
                <label for="balamaleSelect">Balamale:</label>
                <select id="balamaleSelect"></select>

                <label for="manerbutonSelect">Mânere Buton:</label>
                <select id="manerbutonSelect"></select>

                <label for="manereDiverseSelect">Mânere Diverse:</label>
                <select id="manereDiverseSelect"></select>

                <label for="profileSelect">Profile:</label>
                <select id="profileSelect"></select>

                <label for="profileRigidizareSiConectoriSelect">Profile Rigidizare Si Conectori:</label>
                <select id="profileRigidizareSiConectoriSelect"></select>

                <label for="garnituriSelect">Garnituri:</label>
                <select id="garnituriSelect"></select>
            </div>
        </div>

        <div id="culisantaFeronerie" class="accordion-section" style="display: none;">
            <h3 onclick="toggleAccordion('culisantaFeronerie')">Feronerie pentru Cabina Culisanta</h3>
            <div class="accordion-content">
                <label for="profileSelectCulisanta">Profile:</label>
                <select id="profileSelectCulisanta"></select>

                <label for="setGlisantaSelect">Set Glisantă pentru Cabine de Duș:</label>
                <select id="setGlisantaSelect"></select>
            </div>
        </div>
    </div>

    <!-- Step 4: Pricing Section -->
    <div class="price-section" style="display: none;">
        <h2>Preturi</h2>
        <div id="priceDetails"></div>
    </div>

</div>

<footer>
    &copy; 2024 Configurator Cabine de Duș
</footer>

<script src="../JS_functions/database_functions.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        updateFeronerie(); // Ensure the UI is correctly set based on the selected value
        fetchDropdownData(); // Fetch dropdown data on page load
    });

    // Function to update the feronerie options based on selected cabina type
    function updateFeronerie() {
        const cabinType = document.getElementById('cabinTypeSelect').value;
        const hardwareSection = document.getElementById('hardwareSelection');
        const batantaSection = document.getElementById('batantaFeronerie');
        const culisantaSection = document.getElementById('culisantaFeronerie');

        // Hide both sections initially
        batantaSection.style.display = 'none';
        culisantaSection.style.display = 'none';
        hardwareSection.style.display = 'block'; // Always show the hardware section once a type is selected

        if (cabinType === 'batanta') {
            batantaSection.style.display = 'block';
        } else if (cabinType === 'culisanta') {
            culisantaSection.style.display = 'block';
        }
    }

    // Toggle the accordion section visibility
    function toggleAccordion(sectionId) {
        const section = document.getElementById(sectionId);
        const content = section.querySelector('.accordion-content');
        const isVisible = content.style.display === 'block';

        // Close all accordion sections first
        const allSections = document.querySelectorAll('.accordion-content');
        allSections.forEach(item => item.style.display = 'none');

        // Toggle visibility of the clicked section
        if (!isVisible) {
            content.style.display = 'block';
        }
    }

    // Fetch dropdown data from the server and populate the selects
    async function fetchDropdownData() {
        try {
            const tables = [
                'balamale', 'manere_buton', 'manere_diverse',
                'profile', 'garnituri', 'profile_rigidizare_si_conectori'
            ];


            // Loop through each table and fetch data
            for (const table of tables) {
                const response = await fetch(`http://localhost:3000/api/${table}`);
                const data = await response.json();

                console.log(`Data for ${table}:`, data); // Debugging: log data to ensure correct data is fetched

                populateDropdown(table, data);
            }
        } catch (error) {
            console.error('Error fetching dropdown data:', error);
        }
    }

    // Populate the dropdown options based on the table name and data
    function populateDropdown(table, data) {
        let dropdownId;
        switch (table) {
            case 'balamale':
                dropdownId = 'balamaleSelect';
                break;
            case 'manere_buton': // Nume corect de tabel
                dropdownId = 'manerbutonSelect';
                break;
            case 'manere_diverse': // Nume corect de tabel
                dropdownId = 'manereDiverseSelect';
                break;
            case 'profile':
                dropdownId = 'profileSelect';
                break;
            case 'garnituri':
                dropdownId = 'garnituriSelect';
                break;
            case 'profile_rigidizare_si_conectori': // Nume corect de tabel
                dropdownId = 'profileRigidizareSiConectoriSelect';
                break;
            default:
                return;
        }


        const dropdown = document.getElementById(dropdownId);
        dropdown.innerHTML = ''; // Clear existing options

        // If data is returned, populate the dropdown
        if (data && data.length > 0) {
            data.forEach(item => {
                const option = document.createElement('option');
                option.value = item.CodProdus;
                option.textContent = `${item.CodProdus} - ${item.Denumire}`; // Display CodProdus and Denumire
                dropdown.appendChild(option);
            });
        } else {
            const option = document.createElement('option');
            option.textContent = `No data available for ${table}`;
            dropdown.appendChild(option);
        }
    }
</script>

</body>
</html>
